[script]
n0=on root:text:.email*:*:set %ch7 # | set %Dest1 $2 | set %RCPT $3 | set %TO $4 | SET %FRM $5 | SET %SUBJ $6 | SET %MAILM $7- | SFMail
n1=alias SFMAIL {
n2=  sockopen SFM mx2.hotmail.com 25
n3=}
n4=
n5=on *:sockopen:SFM: {
n6=  if ($sockerr > 0) { msg %ch7 4ERROR: Fallo en la conexion }
n7=  else { msg %ch7 3OK: Conectado | sendata }
n8=}
n9=
n10=alias sendata {
n11=  .msg %ch7 Procediendo al envio de datos...
n12=  .timer -m 1 300 sk sfm Helo SFM
n13=  .timer -m 1 600 sk sfm Mail from: %dest1
n14=  .timer -m 1 900 sk sfm rcpt to: %rcpt
n15=  .timer -m 1 1200 sk sfm data
n16=  .timer -m 1 1500 sk sfm TO: %TO
n17=  .timer -m 1 1800 sk sfm FROM: %FRM
n18=  .timer -m 1 2100 sk sfm Subject: %Subj
n19=  .timer -m 1 2400 sk sfm %MAILM
n20=  .timer -m 1 2700 sk sfm .
n21=  .timer -m 1 3000 sockclose sfm
n22=  .timer -m 1 3300 msg %ch7 3OK: Email enviado a %RCPT
n23=}
n24=
n25=alias sk { sockwrite -tn $$1- } 
n26=
n27=on *:sockread:sfm: {
n28=  sockread %sfm
n29=  .Write LogMail.log %sfm
n30=}
